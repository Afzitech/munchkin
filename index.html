<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afsal_Sneha_v2.patch</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #ff4d6d; --secondary: #590d22; --bg: #fff0f3; --dark: #2b2d42; }
        
        body { 
            margin: 0; 
            background: var(--bg); 
            font-family: 'Courier New', Courier, monospace; 
            color: var(--secondary); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            overflow-x: hidden; 
        }

        #container { 
            width: 90%; 
            max-width: 500px; 
            background: white; 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            text-align: center; 
            position: relative; 
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .phase { display: none; }
        .active { display: block; animation: fadeIn 0.8s; }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        #progress-bar {
            width: 25%;
            height: 100%;
            background: var(--primary);
            transition: width 0.5s ease;
        }

        /* Phase 2: Gallery Styling */
        .gallery { 
            display: flex; 
            overflow-x: auto; 
            gap: 15px; 
            padding: 20px 0; 
            scroll-snap-type: x mandatory; 
            scrollbar-width: none;
        }
        .gallery::-webkit-scrollbar { display: none; }
        
        .photo-card { 
            flex: 0 0 85%; 
            scroll-snap-align: center; 
            border: 5px solid white; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
            border-radius: 10px; 
            background: #fff;
        }
        .photo-card img { width: 100%; border-radius: 5px; display: block; }

        /* Buttons */
        .btn-group { 
            display: flex; 
            justify-content: center; 
            gap: 20px; 
            margin-top: 25px; 
            height: 50px; 
            position: relative; 
        }
        
        button { 
            padding: 12px 25px; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            font-weight: bold; 
            font-family: inherit; 
            transition: 0.3s; 
        }

        .btn-next { background: var(--primary); color: white; width: 100%; margin-top: 15px; }
        #yesBtn { background: var(--primary); color: white; font-size: 1.1rem; }
        #noBtn { background: #dee2e6; color: #495057; position: absolute; z-index: 1000; }

        /* Phase 3: Quiz Styling */
        .quiz-input { 
            width: 100%; 
            padding: 12px; 
            margin: 15px 0; 
            border: 2px solid #eee; 
            border-radius: 10px; 
            outline: none; 
            box-sizing: border-box;
            font-family: inherit;
        }
        .quiz-input:focus { border-color: var(--primary); }
        #question-text { font-weight: bold; min-height: 50px; transition: opacity 0.3s; }

        /* Final Heart */
        .heart-loader { font-size: 4rem; animation: beat 1s infinite; margin-bottom: 10px; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
    </style>
</head>
<body>

    <div id="container">
        <div class="progress-container">
            <div id="progress-bar"></div>
        </div>

        <div id="phase1" class="phase active">
            <h1 style="color: var(--primary)">System Alert ‚ö†Ô∏è</h1>
            <p>A major update to <strong>Connection_v2.0</strong> is ready for deployment.</p>
            <p style="font-size: 1.2rem; margin: 25px 0;"><strong>Will you be my Valentine, Ponuzz?</strong></p>
            <div class="btn-group">
                <button id="yesBtn" onclick="goToPhase(2)">YES</button>
                <button id="noBtn">No</button>
            </div>
        </div>

        <div id="phase2" class="phase">
            <h1 style="color: var(--primary)">Restoring Fragments...</h1>
            <p>Scanning 22 memory sectors found in local storage:</p>
            <div class="gallery" id="galleryContainer"></div>
            <p style="font-size: 0.8rem; color: #888;">Swipe to verify all 22 memories &gt;&gt;</p>
            <button class="btn-next" onclick="goToPhase(3)">Next: Security Verification</button>
        </div>

        <div id="phase3" class="phase">
            <h1 style="color: var(--primary)">Identity Check üîê</h1>
            <p style="font-size: 0.8rem;">Answer correctly to merge the Valentine branch.</p>
            <div id="quiz-content">
                <p id="question-text">Loading...</p>
                <input type="text" id="quiz-answer" class="quiz-input" placeholder="Type answer here...">
                <button class="btn-next" onclick="checkAnswer()">Verify Identity</button>
            </div>
        </div>

        <div id="final" class="phase">
            <div class="heart-loader">‚ù§Ô∏è</div>
            <h1 style="color: var(--primary)">Update Complete!</h1>
            <p>Sneha, I'm so glad we're on the same page (literally). Let's make this year amazing. No more 'confusing' vibes, just us.</p>
            <p style="font-size: 0.8rem; color: #888;">- Afsal Rahman J</p>
        </div>
    </div>

    <script>
        const noBtn = document.getElementById('noBtn');
        const progressBar = document.getElementById('progress-bar');

        // Phase Controller
        function goToPhase(num) {
            document.querySelectorAll('.phase').forEach(p => p.classList.remove('active'));
            const target = num === 'final' ? 'final' : 'phase' + num;
            document.getElementById(target).classList.add('active');

            // Update Progress Bar
            if(num === 2) { 
                progressBar.style.width = "50%"; 
                loadGallery();
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            }
            if(num === 3) { 
                progressBar.style.width = "75%"; 
                loadQuestion(); 
            }
            if(num === 'final') { progressBar.style.width = "100%"; }
        }

        // Roaming "No" Button
        function moveNo() {
            const x = Math.random() * (window.innerWidth - noBtn.offsetWidth - 20);
            const y = Math.random() * (window.innerHeight - noBtn.offsetHeight - 20);
            noBtn.style.position = 'fixed';
            noBtn.style.left = x + 'px';
            noBtn.style.top = y + 'px';
        }
        noBtn.addEventListener('mouseover', moveNo);
        noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNo(); });

        // Gallery Loader
        function loadGallery() {
            const container = document.getElementById('galleryContainer');
            if(container.children.length > 0) return;
            for(let i = 1; i <= 22; i++) {
                const card = document.createElement('div');
                card.className = 'photo-card';
                card.innerHTML = `<img src="${i}.jpg" alt="Memory ${i}">`;
                container.appendChild(card);
            }
        }

        // Quiz Logic
        const questions = [
            { q: "nammal onicha day etha?? (Format: dd/mm/yyyy):", a: "27/10/2023" },
            { q: "namadae kuduthal memories ulla place? (Hint: üåä)", a: "beach" },
            { q: "nindae kai irunu njn adichu matiya food? (His favorite heist)", a: "chole bhature" },
            { q: "endae ethu body part paranja nee enne kali akaru?", a: "kunu vayaru" },
            { q: "nindae ormaikai  eniku kuduthal thana oru sathanam? (Hint: ü¶∑)", a: "kadi" },
            { q: "Last one: pinnaiyum enne onu vazhaku paraiyanum, adi idakanum varan ready ahno?", a: "yes" }
        ];

        let currentQ = 0;

        function loadQuestion() {
            const qText = document.getElementById('question-text');
            qText.style.opacity = 0;
            setTimeout(() => {
                qText.innerText = questions[currentQ].q;
                qText.style.opacity = 1;
            }, 300);
            document.getElementById('quiz-answer').value = "";
        }

        function checkAnswer() {
            const userAns = document.getElementById('quiz-answer').value.toLowerCase().trim();
            const correctAns = questions[currentQ].a;

            if (correctAns === "any" || userAns.includes(correctAns) || (correctAns === "chole bhature" && userAns.includes("chole"))) {
                currentQ++;
                if (currentQ < questions.length) {
                    loadQuestion();
                } else {
                    goToPhase('final');
                    triggerFinalConfetti();
                }
            } else {
                alert("Incorrect key! Try again, Sneha. ‚ù§Ô∏è");
            }
        }

        function triggerFinalConfetti() {
            const end = Date.now() + (5 * 1000);
            (function frame() {
                confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff4d6d', '#ff758f'] });
                confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff4d6d', '#ff758f'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
    </script>
</body>
</html>
